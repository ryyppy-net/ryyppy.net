<!DOCTYPE html>
<html>
    <head>
        <title></title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script type="text/javascript" src="/static/js/jquery.js"></script>
        <script type="text/javascript" src="/static/js/jquery.tmpl.js"></script>
        <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0;">
        
        <script type="text/javascript">
            $(document).ready(function() {
                var picker = new DateTimePicker('#drinkTime');
            });
            
            function DateTimePicker(element) {
                this.element = element;
                this.selectedTime = new Date();
                
                this.appendTemplate();
            }
            
            
            
            DateTimePicker.prototype.showSelectedTime = function() {
                $('#dateDay').val(this.selectedTime.getDate());
                $('#dateMonth').val(this.selectedTime.getMonth() + 1);
                $('#dateYear').val(this.selectedTime.getFullYear());
                
                $('#dateHour').val(this.selectedTime.getHours());
                $('#dateMinute').val(this.selectedTime.getMinutes());
            }
            
            DateTimePicker.prototype.adjustWidths = function() {
                var widest = 0;
                $('td', $(this.element)).each(function(index) {
                    widest = Math.max(widest, $(this).width());
                }).width(widest);
            }
            
            DateTimePicker.prototype.appendTemplate = function() {
                var that = this;
                
                $.get('/static/templates/datetimepicker.html', function(template) {
                    $.tmpl(template, undefined).appendTo(that.element);
                    
                    that.adjustWidths();
                    that.showSelectedTime();
                    that.initializeButtons();
                });                
            }
            
            DateTimePicker.prototype.manipulateDate = function(event, manipulationFunction) {
                event.preventDefault();
                if (typeof manipulationFunction !== undefined)
                    manipulationFunction();
                this.setSelectedTime();
                return false;
            }
            
            DateTimePicker.prototype.initializeButtons = function() {
                var that = this;

                $('#increaseDays').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setDate(that.selectedTime.getDate() + 1);
                    });
                });
                
                $('#decreaseDays').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setDate(that.selectedTime.getDate() - 1);
                    });
                });

                $('#increaseMonths').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setMonth(that.selectedTime.getMonth() + 1);
                    });
                });
                
                $('#decreaseMonths').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setMonth(that.selectedTime.getMonth() - 1);
                    });
                });

                $('#increaseYears').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setYear(that.selectedTime.getFullYear() + 1);
                    });
                });
                
                $('#decreaseYears').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setYear(that.selectedTime.getFullYear() - 1);
                    });
                });
                
                $('#increaseHours').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setHours(that.selectedTime.getHours() + 1);
                    });
                });
                
                $('#decreaseHours').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setHours(that.selectedTime.getHours() - 1);
                    });
                });

                $('#increaseMinutes').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setMinutes(that.selectedTime.getMinutes() + 1);
                    });
                });
                
                $('#decreaseMinutes').click(function(event) {
                    return that.manipulateDate(event, function() {
                        that.selectedTime.setMinutes(that.selectedTime.getMinutes() - 1);
                    });
                });
            }
        </script>
        
        <style type="text/css">
            .datetimepicker td {
                text-align: center;
            }
            
            .datetimepicker input {
                font-size: 1.0em;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <div id="drinkTime"></div>
    </body>
</html>
